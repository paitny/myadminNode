import{_ as V,o as f,c as C,w as l,r as a,b as u,a as s,d as b,C as F,f as p,G as S,H as k}from"./index.d654a29a.js";const R={name:"MusicAdd",data(){return{form:{name:"",artist:"",lrc:"",url:"",cover:"",theme:""},imageUrl:""}},methods:{submitForm(){this.$refs.musicForm.submit(),this.$refs.lrcForm.submit()},async submit(){let{data:e}=await this.$axios({method:"POST",url:"/adminServer/music/add",data:this.form});if(e.code)return this.$message.error(e.msg);await this.$router.push("/music/micMg")},fileChangemusic(e,t){if(e.status==="ready")if(/^(.+)\.(mp3|m4a)$/.test(e.name)){if(this.form.name)return;this.form.name=RegExp.$1}else this.$message.error("\u53EA\u80FD\u4E0A\u4F20 .md \u6587\u4EF6"),t.pop()},beforeRemovemusic(){this.form.name=""},music_upload_success(e){if(e.code)return this.$message.error("\u4E0A\u4F20md\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u540E\u7AEF\u62A5\u9519");this.form.url=e.url,this.imageUrl?this.$refs.imgForm.submit():this.submit()},fileChangelrc(e,t){e.status==="ready"&&(/^(.+)\.lrc$/.test(e.name)||(this.$message.error("\u53EA\u80FD\u4E0A\u4F20 .lrc \u683C\u5F0F\u7684\u6B4C\u8BCD\u6587\u4EF6"),t.pop()))},lrc_upload_success(e){if(e.code)return this.$message.error("\u4E0A\u4F20\u6B4C\u8BCD\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u540E\u7AEF\u62A5\u9519");this.form.lrc=e.url},coverChange(e,t){if(e.status!=="ready")return;const m=/^image\/(jpeg|png)$/.test(e.raw.type),n=e.raw.size/1024/1024<2;m||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u53EA\u80FD\u662F JPG/PNG \u683C\u5F0F!"),n||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),m&&n?this.imageUrl=URL.createObjectURL(e.raw):(this.imageUrl="",t.pop())},cover_upload_success(e){if(e.code)return this.$message.error("\u4E0A\u4F20\u5C01\u9762\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u540E\u7AEF\u62A5\u9519");this.form.cover=e.url,this.submit()}}},v=e=>(S("data-v-85befc28"),e=e(),k(),e),$={id:"ArticleAdd"},A={class:"el-icon-upload"},B=v(()=>u("div",{class:"el-upload__text"},[p("\u5C06.\u97F3\u4E50\u6587\u4EF6\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),u("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),L=p("\u6B4C\u8BCD"),M=v(()=>u("div",{class:"el-upload__tip"}," jpg/png files with a size less than 500KB. ",-1)),P={key:1,class:"el-icon-plus avatar-uploader-icon"},z=p("\u786E\u8BA4\u53D1\u8868");function I(e,t,m,n,o,r){const d=a("el-input"),i=a("el-form-item"),w=a("upload-filled"),h=a("el-icon"),_=a("el-upload"),g=a("el-button"),y=a("Plus"),x=a("el-form"),U=a("el-card");return f(),C(U,null,{default:l(()=>[u("div",$,[s(x,{model:o.form,"status-icon":"",ref:"ruleForm","label-width":"100px"},{default:l(()=>[s(i,{label:"\u97F3\u4E50\u540D\u5B57\uFF1A","label-width":"100px"},{default:l(()=>[s(d,{modelValue:o.form.name,"onUpdate:modelValue":t[0]||(t[0]=c=>o.form.name=c),placeholder:"\u53EF\u901A\u8FC7\u4E0A\u4F20 music \u81EA\u52A8\u83B7\u53D6\u6587\u4EF6\u540D"},null,8,["modelValue"])]),_:1}),s(i,{label:"\u6F14\u5531\u8005\uFF1A","label-width":"100px"},{default:l(()=>[s(d,{modelValue:o.form.artist,"onUpdate:modelValue":t[1]||(t[1]=c=>o.form.artist=c)},null,8,["modelValue"])]),_:1}),s(i,{label:"\u4E3B\u9898\u989C\u8272\uFF1A","label-width":"100px"},{default:l(()=>[s(d,{modelValue:o.form.theme,"onUpdate:modelValue":t[2]||(t[2]=c=>o.form.theme=c)},null,8,["modelValue"])]),_:1}),s(i,{label:"\u97F3\u4E50\u4E0A\u4F20\uFF1A","label-width":"100px"},{default:l(()=>[s(_,{class:"upload-demo",drag:"",action:`${e.baseURL}/adminServer/music/musicAdd`,"auto-upload":!1,"on-change":r.fileChangemusic,"on-success":r.music_upload_success,"before-remove":r.beforeRemovemusic,limit:1,ref:"musicForm","with-credentials":!0},{default:l(()=>[u("i",A,[s(h,{class:"el-icon--upload"},{default:l(()=>[s(w)]),_:1})]),B]),_:1},8,["action","on-change","on-success","before-remove"])]),_:1}),s(i,{label:"\u6B4C\u8BCD\u4E0A\u4F20\uFF1A","label-width":"100px"},{default:l(()=>[s(_,{class:"upload-demo",action:`${e.baseURL}/adminServer/music/lrc`,multiple:"","auto-upload":!1,"on-change":r.fileChangelrc,"on-success":r.lrc_upload_success,limit:1,"with-credentials":!0,ref:"lrcForm"},{tip:l(()=>[M]),default:l(()=>[s(g,{type:"primary",size:"large"},{default:l(()=>[L]),_:1})]),_:1},8,["action","on-change","on-success"])]),_:1}),s(i,{label:"\u5C01\u9762\u56FE\u4E0A\u4F20\uFF1A","label-width":"100px"},{default:l(()=>[s(_,{class:"avatar-uploader",action:`${e.baseURL}/adminServer/music/cover`,"show-file-list":!1,"on-change":r.coverChange,"on-success":r.cover_upload_success,"auto-upload":!1,ref:"imgForm","with-credentials":!0},{default:l(()=>[o.imageUrl?(f(),b("div",{key:0,class:"avatar",style:F({backgroundImage:`url(${o.imageUrl})`})},null,4)):(f(),b("i",P,[s(h,null,{default:l(()=>[s(y)]),_:1})]))]),_:1},8,["action","on-change","on-success"])]),_:1}),s(i,{"label-width":"100px"},{default:l(()=>[s(g,{type:"primary",onClick:r.submitForm,size:"large"},{default:l(()=>[z]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])])]),_:1})}const N=V(R,[["render",I],["__scopeId","data-v-85befc28"]]);export{N as default};
